Build Metasploit on Linux (debian/kali)

=======================================
Install Metasploit
=======================================
sudo apt-get install libxslt1-dev libxml2-dev postgresql ruby
sudo apt-get install libsqlite3-dev ruby-pkg-config libpq-dev ruby2.3-dev libpcap0.8-dev

sudo -s
cd /opt
git clone https://github.com/rapid7/metasploit-framework/
mv metasploit-framework metasploit
cd metasploit
sudo gem install bundler

cd metasploit-framework
rm .*
rm -rf .git
rm -r .github

bundle config build.nokogiri --use-system-libraries
bundle install --path vendor

ln -s /opt/metasploit/msfconsole /usr/local/bin/msf
ln -s /opt/metasploit/msfconsole /usr/local/bin/msfconsole
ln -s /opt/metasploit/msfd /usr/local/bin/msfd
ln -s /opt/metasploit/msfrpc /usr/local/bin/msfrpc
ln -s /opt/metasploit/msfrpcd /usr/local/bin/msfrpcd
ln -s /opt/metasploit/msfupdate /usr/local/bin/msfupdate
ln -s /opt/metasploit/msfvenom /usr/local/bin/msfvenom
ln -s /opt/metasploit/Rakefile /usr/local/bin/Rakefile

MSFROOT=/opt/metasploit
GEMFILE=$MSFROOT/Gemfile
echo "export BUNDLE_GEMFILE=$GEMFILE" >> /etc/profile
echo "export MSF_DATABASE_CONFIG=$MSFROOT/config/database.yml" >> /etc/profile
echo "export GEM_PATH=$MSFROOT/vendor/ruby/2.3.0" >> /etc/profile

=======================================
Initialization
=======================================
# Startup PostgreSQL Database ï¼š
sudo /etc/init.d/postgresql start
or
sudo service postgresql start

# Configuration VNCViewer
echo '#!/usr/bin/env bash'>> /usr/local/bin/vncviewer
echo open vnc://\$1 >> /usr/local/bin/vncviewer
chmod +x /usr/local/bin/vncviewer

# PostgreSQL Create Database & Username
wget https://raw.githubusercontent.com/Mint-Fans/linux-package/kali/msfdb
sudo chmod 755 msfdb
sudo chown 0:0 msfdb
sudo mv msfdb /usr/local/bin/
sudo msfdb init

# Run Metasploit
sudo msfconsole

# View database connection status
> db_status
> db_rebuild_cache

# exit
> quit


=======================================
Remove Metasploit
=======================================
sudo -s
sed -i '/metasploit/d' /etc/profile 

rm /usr/local/bin/msf
rm /usr/local/bin/msfconsole
rm /usr/local/bin/msfd
rm /usr/local/bin/msfrpc
rm /usr/local/bin/msfrpcd
rm /usr/local/bin/msfupdate
rm /usr/local/bin/msfvenom
rm /usr/local/bin/Rakefile
