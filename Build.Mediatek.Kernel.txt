###############################################
### Build Mediatek Kernel
###############################################
# Download Kernel Source Code
mkdir -p linux-mtk-4.4.95
cd linux-mtk-4.4.95
git clone https://github.com/parthibx24/android_kernel_wiko_p200.git kernel/mediatek

# Download toolchain
git clone https://android.googlesource.com/kernel/build build -b master --depth=1
git clone https://android.googlesource.com/kernel/tests kernel/tests -b pie-release

git clone https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9 prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9 -b pie-release --depth=1
git clone https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/arm/arm-linux-androideabi-4.9 prebuilts/gcc/linux-x86/arm/arm-linux-androideabi-4.9 -b pie-release --depth=1
git clone https://android.googlesource.com/platform/prebuilts/clang/host/linux-x86 prebuilts-master/clang/host/linux-x86 -b pie-release --depth=1
git clone https://android.googlesource.com/platform/prebuilts/misc prebuilts-master/misc -b pie-release --depth=1

# Device Config
curl https://raw.githubusercontent.com/Mint-Fans/linux-package/Android/mt6739_defconfig > kernel/mediatek/arch/arm/configs/mt6739_defconfig

# Patch
cp kernel/mediatek/build.config.goldfish.arm kernel/mediatek/build.config
sed -i 's/DEFCONFIG=.*/DEFCONFIG=mt6739_defconfig/g' kernel/mediatek/build.config
sed -i 's/KERNEL_DIR=.*/KERNEL_DIR=kernel\/mediatek/g' kernel/mediatek/build.config
ln -s kernel/mediatek/build.config .

# Build Kernel
source build/envsetup.sh && build/build.sh

# Test Kernel
fastboot boot Image.lz4-dtb

# View Kernel Log
adb shell dmesg

