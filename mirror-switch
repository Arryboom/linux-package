#!/bin/bash

###### Translations ###### 
	text0="LMAE Repository Switch"
	text1="1).Switching Latest Archlinux Official Repository"
	text2="2).Switching LMAE Repository (Arch Linux Archive 20160320)"
	text3="3).Custom Arch Linux Archive Repository"
	text4="0).Press 0 to exit"
	text5="Options:"

	text6="Custom Arch Linux Archive Repository"
	text7="Enter dates, for example: 2016/07/03"

case $LANG in
	zh_TW* | zh_HK*)
	text0="LMAE 套件庫切換"
	text1="1).切換 Arch linux 官方最新套件庫"
	text2="2).切換 LMAE 套件庫 (即 Arch Linux Archive 20170208)"
	text3="3).自訂 Arch Linux Archive 套件庫"
	text4="0).按「0」退出"
	text5="輸入選項:"

	text6="自訂 Arch Linux Archive 套件庫"
	text7="輸入日期, 範例: 2016/07/03"

esac

main_fun(){
clear
cat << ENTER

  $text0

  $text1
  $text2
  $text3
  $text4
  $text5

ENTER

read switch
[[ "$switch" ]] && switch="$switch"

## Latest Archlinux Official Repository
if [ "$switch" == "1" ]; then
	rm -rf /etc/pacman.d/mirrorlist
	cp -rf /etc/pacman.d/pkglist-current /etc/pacman.d/mirrorlist
	rm -rf /var/lib/pacman/sync/*
	pacman -Sy
	exit
## LMAE Repository (ArchLinux mirrorlist 20160320)
elif [ "$switch" == "2" ]; then
	sh -c 'echo Server = https://archive.archlinux.org/repos/2017/02/08/$repo/os/$arch > /etc/pacman.d/mirrorlist'
	sed -i 's/\/os\//$repo\/os\/$arch/g' /etc/pacman.d/mirrorlist
	rm -rf /var/lib/pacman/sync/*
	pacman -Sy
	exit
elif [ "$switch" == "3" ]; then
	edit_ala_fun
elif [ "$switch" == "0" ]; then
	exit
else
	main_fun
fi
}

edit_ala_fun(){
clear
cat << ENTER

  $text6
  $text7

ENTER

read ala
[[ "$ala" ]] && ala=$ala
if [ "$ala" == "" ]; then
	edit_ala_fun
fi

cat > /etc/pacman.d/mirrorlist << EOF
Server = https://archive.archlinux.org/repos/$ala/$repo/os/$arch
EOF
## sh -c 'echo Server = https://archive.archlinux.org/repos/$ala/$repo/os/$arch > /etc/pacman.d/mirrorlist'
sed -i 's/\/os\//$repo\/os\/$arch/g' /etc/pacman.d/mirrorlist
rm -rf /var/lib/pacman/sync/*
pacman -Sy
exit
}

main_fun

